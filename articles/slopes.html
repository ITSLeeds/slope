<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • slopes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="slopes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slopes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/slopes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark.html">Benchmarking slopes calculation</a>
    </li>
    <li>
      <a href="../articles/intro-to-slopes.html">An introduction to slopes</a>
    </li>
    <li>
      <a href="../articles/roadnetworkcycling.html">Example: gradients of a road network for a given city</a>
    </li>
    <li>
      <a href="../articles/verification.html">Verification of slopes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/slopes/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="slopes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="slopes_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="slopes_files/jquery-1.12.4/jquery.min.js"></script><link href="slopes_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="slopes_files/leaflet-1.3.1/leaflet.js"></script><link href="slopes_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="slopes_files/proj4-2.6.2/proj4.min.js"></script><script src="slopes_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="slopes_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="slopes_files/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="slopes_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="slopes_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="slopes_files/clipboard-0.0.1/setClipboardText.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/itsleeds/slopes/blob/master/vignettes/slopes.Rmd"><code>vignettes/slopes.Rmd</code></a></small>
      <div class="hidden name"><code>slopes.Rmd</code></div>

    </div>

    
    
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the released version of slopes from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("slopes") -->
<!-- ``` -->
<p>Install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"itsleeds/slopes"</span><span class="op">)</span></code></pre></div>
<div id="installation-for-dem-downloads" class="section level4">
<h4 class="hasAnchor">
<a href="#installation-for-dem-downloads" class="anchor"></a>Installation for DEM downloads</h4>
<p>If you do not already have DEM data and want to make use of the package’s ability to download them using the <code>ceramic</code> package, install the package with suggested dependencies, as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"itsleeds/slopes"</span>, dependencies <span class="op">=</span> <span class="st">"Suggests"</span><span class="op">)</span></code></pre></div>
<p>Furthermore, you will need to add a MapBox API key to be able to get DEM datasets, by signing up and registering for a key at <a href="https://account.mapbox.com/access-tokens/" class="uri">https://account.mapbox.com/access-tokens/</a> and then following these steps:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu">edit_r_environ</span><span class="op">(</span><span class="op">)</span>
<span class="va">MAPBOX_API_KEY</span><span class="op">=</span><span class="va">xxxxx</span> <span class="co"># replace XXX with your api key</span></code></pre></div>
</div>
</div>
<div id="functions" class="section level2">
<h2 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h2>
<div id="elevation" class="section level3">
<h3 class="hasAnchor">
<a href="#elevation" class="anchor"></a>Elevation</h3>
<ul>
<li><p><code><a href="../reference/elevation_add.html">elevation_add()</a></code> Take a linestring and add a third dimension (z) to its coordinates</p></li>
<li><p><code><a href="../reference/elevation_get.html">elevation_get()</a></code> Get elevation data from hosted maptile services (returns a raster)</p></li>
<li><p><code><a href="../reference/elevation_extract.html">elevation_extract()</a></code> Extract elevations from coordinates</p></li>
<li><p><code><a href="../reference/z_value.html">z_value()</a></code> retrieves elevation values for each z (as vector of sequential vertices)</p></li>
<li><p><code><a href="../reference/z_value.html">z_start()</a></code> retrieves the elevation value of the first linestring vertice</p></li>
<li><p><code><a href="../reference/z_value.html">z_end()</a></code> retrieves the elevation value of the last linestring vertice</p></li>
<li><p><code><a href="../reference/z_value.html">z_mean()</a></code> retrieves the elevation mean value</p></li>
<li><p><code><a href="../reference/z_value.html">z_max()</a></code> retrieves the elevation max value</p></li>
<li><p><code><a href="../reference/z_value.html">z_min()</a></code> retrieves the elevation min value</p></li>
</ul>
</div>
<div id="distance" class="section level3">
<h3 class="hasAnchor">
<a href="#distance" class="anchor"></a>Distance</h3>
<ul>
<li>
<code><a href="../reference/sequential_dist.html">sequential_dist()</a></code> Calculate the sequential distances between sequential coordinate pairs</li>
</ul>
</div>
<div id="slope" class="section level3">
<h3 class="hasAnchor">
<a href="#slope" class="anchor"></a>Slope</h3>
<ul>
<li><p><code><a href="../reference/slope_vector.html">slope_vector()</a></code> calculates the slopes associated with consecutive elements in one dimensional distance and associated elevations.</p></li>
<li><p><code><a href="../reference/slope_vector.html">slope_distance()</a></code> calculates the slopes associated with consecutive distances and elevations.</p></li>
<li><p><code><a href="../reference/slope_vector.html">slope_distance_mean()</a></code> calculates the mean average slopes associated with consecutive distances and elevations.</p></li>
<li><p><code><a href="../reference/slope_vector.html">slope_distance_weighted()</a></code> calculates the slopes associated with consecutive distances and elevations, with the mean value associated with each set of distance/elevation vectors weighted in proportion to the distance between each elevation measurement, so longer sections have proportionally more influence on the resulting gradient estimate.</p></li>
<li><p><code><a href="../reference/slope_raster.html">slope_raster()</a></code> Calculate slopes of linestrings based on local raster map</p></li>
<li><p><code><a href="../reference/slope_matrix.html">slope_matrix()</a></code> Calculate the gradient of line segments from a 3D matrix of coordinates</p></li>
<li><p><code><a href="../reference/slope_matrix.html">slope_matrix_weighted()</a></code> Calculate the weighted gradient of line segments from a 3D matrix of coordinates</p></li>
<li><p><code><a href="../reference/slope_xyz.html">slope_xyz()</a></code> Calculates the slope associated with linestrings that have xyz coordinates</p></li>
</ul>
</div>
<div id="plot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot" class="anchor"></a>Plot</h3>
<ul>
<li>
<code><a href="../reference/plot_dz.html">plot_dz()</a></code> Plot a digital elevation profile based on xyz data</li>
<li>
<code><a href="../reference/plot_slope.html">plot_slope()</a></code> Plots the slope profile associated with a linestring with base R graphics</li>
</ul>
</div>
</div>
<div id="package-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#package-datasets" class="anchor"></a>Package datasets</h2>
<p>The <code>slopes</code> package comes with some datasets to play with:</p>
<p><strong>Linestrings:</strong></p>
<ul>
<li>
<code>lisbon_road_segment</code>: a single road segment in Lisbon (XY)</li>
<li>
<code>lisbon_route</code>: a route with some variation in elevation in Lisbon (XY)</li>
<li>
<code>cyclestreets_route</code>: a bike route in Leeds (XY)</li>
</ul>
<p><strong>Road network:</strong></p>
<ul>
<li>
<code>lisbon_road_network</code>: a sample of road segments in downtown Lisbon</li>
<li>
<code>magnolia_xy</code>: a sample of road segments in center Seattle, in the Magnolia neighborhood</li>
</ul>
<p><strong>Digital elevation model (DEM):</strong></p>
<ul>
<li>
<code>dem_lisbon_raster</code> a DEM of downtown Lisbon (EPSG:3763)</li>
</ul>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Load the package in the usual way. We will also load the <code>sf</code> library:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/itsleeds/slopes/">slopes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></code></pre></div>
<p>The minimum input data requirement for using the package is an <code>sf</code> object containing LINESTRING geometries.</p>
<p>You can also create <code>sf</code> objects from a matrix of coordinates, as illustrated below (don’t worry about the details for now, you can read up on how all this works in the <code>sf</code> package <a href="https://r-spatial.github.io/sf/articles/sf1.html">documentation</a>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9.1333</span>, <span class="op">-</span><span class="fl">9.134</span>, <span class="op">-</span><span class="fl">9.13</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">38.714</span>, <span class="fl">38.712</span>, <span class="fl">38.710</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">sf_linestring</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>,
  crs <span class="op">=</span> <span class="fl">4326</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] LINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<blockquote>
<p>maybe remove this? or add step 1 and step 2 again.</p>
</blockquote>
<div id="single-road-segment-no-dem" class="section level3">
<h3 class="hasAnchor">
<a href="#single-road-segment-no-dem" class="anchor"></a>Single road segment + no DEM</h3>
<p>You can check your input dataset is suitable with the functions <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> from base R and <code><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type()</a></code> from the <code>sf</code> package, as demonstrated below on the example object <code>lisbon_road_segment</code> that is contained within the package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sf_linestring</span> <span class="op">=</span> <span class="va">lisbon_road_segment</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] LINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<p>A quick way of testing if your object can have slopes calculated for it is to plot it in an interactive map and to check that underneath the object there is indeed terrain that will give the linestrings gradient:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtennekes/tmap">tmap</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html">tm_lines</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_tiles.html">tm_basemap</a></span><span class="op">(</span><span class="fu">leaflet</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/leaflet/man/providers.html">providers</a></span><span class="op">$</span><span class="va">Esri.WorldTopoMap</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-4f572fb951cf1eb7163c" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4f572fb951cf1eb7163c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolylines","args":[[[[{"lng":[-9.13412999964458,-9.13414199974454,-9.13415399982196,-9.13416599987686,-9.13417799990922,-9.13418999991905,-9.13424999976135,-9.13430999956965,-9.13430399968863,-9.13429799982423,-9.13429199997645,-9.13428600014529,-9.13428000033075,-9.13417999987329,-9.13416999980976,-9.13415999976403,-9.13414999973609,-9.13408999988168,-9.13403000008549],"lat":[38.7136300001706,38.7135580001067,38.7134860000411,38.7134139999737,38.7133419999045,38.7132699998335,38.7132499998519,38.7132299998399,38.7131439999249,38.7130580000082,38.7129720000897,38.7128860001694,38.7128000002474,38.7127699997066,38.7127099997068,38.7126499997052,38.712589999702,38.7125549999089,38.712520000084]}]]],"X2997","sf_linestring",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#000000","weight":5,"opacity":1,"fill":false,"fillColor":"#000000","fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>2997<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>OBJECTID<\/nobr><\/td><td align=\"right\"><nobr>2,997<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>fid_1<\/nobr><\/td><td align=\"right\"><nobr>2,997<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>gradient_s<\/nobr><\/td><td align=\"right\"><nobr>0.078<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Shape_Leng<\/nobr><\/td><td align=\"right\"><nobr>182.3<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Z_Min<\/nobr><\/td><td align=\"right\"><nobr>86.49<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Z_Max<\/nobr><\/td><td align=\"right\"><nobr>92.31<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Z_Mean<\/nobr><\/td><td align=\"right\"><nobr>89.91<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>SLength<\/nobr><\/td><td align=\"right\"><nobr>183.3<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Min_Slope<\/nobr><\/td><td align=\"right\"><nobr>0.334<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Max_Slope<\/nobr><\/td><td align=\"right\"><nobr>31.96<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Avg_Slope<\/nobr><\/td><td align=\"right\"><nobr>7.487<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>z0<\/nobr><\/td><td align=\"right\"><nobr>92.31<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>z1<\/nobr><\/td><td align=\"right\"><nobr>89.48<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>gradverifi<\/nobr><\/td><td align=\"right\"><nobr>1.555<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>query<\/nobr><\/td><td align=\"right\"><nobr>lisbon<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lat<\/nobr><\/td><td align=\"right\"><nobr>38.71<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lon<\/nobr><\/td><td align=\"right\"><nobr>-9.137<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lat_min<\/nobr><\/td><td align=\"right\"><nobr>38.69<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lat_max<\/nobr><\/td><td align=\"right\"><nobr>38.80<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lon_min<\/nobr><\/td><td align=\"right\"><nobr>-9.230<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>lon_max<\/nobr><\/td><td align=\"right\"><nobr>-9.086<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>bbox<\/nobr><\/td><td align=\"right\"><nobr>list(c(-9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, \n-9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, \n-9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.2298356, -9.22878201, -9.22772681880597, -9.22667162761194, -9.22561643641791, -9.22456124522388, -9.22350605402985, -9.22245086283582, -9.22139567164179, -9.22034048044776, -9.21928528925373, -9.2182300980597, -9.21717490686567, -9.21611971567164, -9.21506452447761, -9.21400933328358, -9.21295414208955, \n-9.21189895089552, -9.21084375970149, -9.20978856850746, -9.20873337731343, -9.2076781861194, -9.20662299492537, -9.20556780373134, -9.20451261253731, -9.20345742134328, -9.20240223014925, -9.20134703895522, -9.20029184776119, -9.19923665656716, -9.19818146537313, -9.1971262741791, -9.19607108298507, -9.19501589179104, -9.19396070059701, -9.19290550940299, -9.19185031820895, -9.19079512701492, -9.1897399358209, -9.18868474462687, -9.18762955343283, -9.18657436223881, -9.18551917104478, -9.18446397985075, \n-9.18340878865672, -9.18235359746269, -9.18129840626866, -9.18024321507463, -9.1791880238806, -9.17813283268657, -9.17707764149254, -9.17602245029851, -9.17496725910448, -9.17391206791045, -9.17285687671642, -9.17180168552239, -9.17074649432836, -9.16969130313433, -9.1686361119403, -9.16758092074627, -9.16652572955224, -9.16547053835821, -9.16441534716418, -9.16336015597015, -9.16230496477612, -9.16124977358209, -9.16019458238806, -9.15913939119403, -9.1580842, -9.15702900880597, -9.15597381761194, \n-9.15491862641791, -9.15386343522388, -9.15280824402985, -9.15175305283582, -9.15069786164179, -9.14964267044776, -9.14858747925373, -9.1475322880597, -9.14647709686567, -9.14542190567164, -9.14436671447761, -9.14331152328358, -9.14225633208955, -9.14120114089552, -9.14014594970149, -9.13909075850746, -9.13803556731343, -9.1369803761194, -9.13592518492537, -9.13486999373134, -9.13381480253731, -9.13275961134328, -9.13170442014925, -9.13064922895522, -9.12959403776119, -9.12853884656716, -9.12748365537313, \n-9.1264284641791, -9.12537327298507, -9.12431808179104, -9.12326289059701, -9.12220769940298, -9.12115250820895, -9.12009731701492, -9.1190421258209, -9.11798693462686, -9.11693174343283, -9.11587655223881, -9.11482136104478, -9.11376616985075, -9.11271097865671, -9.11165578746269, -9.11060059626866, -9.10954540507463, -9.1084902138806, -9.10743502268657, -9.10637983149254, -9.10532464029851, -9.10426944910448, -9.10321425791045, -9.10215906671642, -9.10110387552239, -9.10004868432836, -9.09899349313433, \n-9.0979383019403, -9.09688311074627, -9.09582791955224, -9.09477272835821, -9.09371753716418, -9.09266234597015, -9.09160715477612, -9.09055196358209, -9.08949677238806, -9.08844158119403, -9.08738639, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, \n-9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, \n-9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.0863328, -9.08738639, -9.08844158119403, -9.08949677238806, -9.09055196358209, -9.09160715477612, -9.09266234597015, \n-9.09371753716418, -9.09477272835821, -9.09582791955224, -9.09688311074627, -9.0979383019403, -9.09899349313433, -9.10004868432836, -9.10110387552239, -9.10215906671642, -9.10321425791045, -9.10426944910448, -9.10532464029851, -9.10637983149254, -9.10743502268657, -9.1084902138806, -9.10954540507463, -9.11060059626866, -9.11165578746269, -9.11271097865671, -9.11376616985075, -9.11482136104478, -9.11587655223881, -9.11693174343283, -9.11798693462686, -9.1190421258209, -9.12009731701492, -9.12115250820895, \n-9.12220769940298, -9.12326289059701, -9.12431808179104, -9.12537327298507, -9.1264284641791, -9.12748365537313, -9.12853884656716, -9.12959403776119, -9.13064922895522, -9.13170442014925, -9.13275961134328, -9.13381480253731, -9.13486999373134, -9.13592518492537, -9.1369803761194, -9.13803556731343, -9.13909075850746, -9.14014594970149, -9.14120114089552, -9.14225633208955, -9.14331152328358, -9.14436671447761, -9.14542190567164, -9.14647709686567, -9.1475322880597, -9.14858747925373, -9.14964267044776, \n-9.15069786164179, -9.15175305283582, -9.15280824402985, -9.15386343522388, -9.15491862641791, -9.15597381761194, -9.15702900880597, -9.1580842, -9.15913939119403, -9.16019458238806, -9.16124977358209, -9.16230496477612, -9.16336015597015, -9.16441534716418, -9.16547053835821, -9.16652572955224, -9.16758092074627, -9.1686361119403, -9.16969130313433, -9.17074649432836, -9.17180168552239, -9.17285687671642, -9.17391206791045, -9.17496725910448, -9.17602245029851, -9.17707764149254, -9.17813283268657, \n-9.1791880238806, -9.18024321507463, -9.18129840626866, -9.18235359746269, -9.18340878865672, -9.18446397985075, -9.18551917104478, -9.18657436223881, -9.18762955343283, -9.18868474462687, -9.1897399358209, -9.19079512701492, -9.19185031820895, -9.19290550940299, -9.19396070059701, -9.19501589179104, -9.19607108298507, -9.1971262741791, -9.19818146537313, -9.19923665656716, -9.20029184776119, -9.20134703895522, -9.20240223014925, -9.20345742134328, -9.20451261253731, -9.20556780373134, -9.20662299492537, \n-9.2076781861194, -9.20873337731343, -9.20978856850746, -9.21084375970149, -9.21189895089552, -9.21295414208955, -9.21400933328358, -9.21506452447761, -9.21611971567164, -9.21717490686567, -9.2182300980597, -9.21928528925373, -9.22034048044776, -9.22139567164179, -9.22245086283582, -9.22350605402985, -9.22456124522388, -9.22561643641791, -9.22667162761194, -9.22772681880597, -9.22878201, -9.2298356, 38.6913994, 38.69245299, 38.69350658, 38.69456017, 38.69561376, 38.69666735, 38.69772094, 38.69877453, \n38.69982812, 38.70088171, 38.7019353, 38.70298889, 38.70404248, 38.70509607, 38.70614966, 38.70720325, 38.70825684, 38.70931043, 38.71036402, 38.71141761, 38.7124712, 38.71352479, 38.71457838, 38.71563197, 38.71668556, 38.71773915, 38.71879274, 38.71984633, 38.72089992, 38.72195351, 38.7230071, 38.72406069, 38.72511428, 38.72616787, 38.72722146, 38.72827505, 38.72932864, 38.73038223, 38.73143582, 38.73248941, 38.733543, 38.73459659, 38.73565018, 38.73670377, 38.73775736, 38.73881095, 38.73986454, \n38.74091813, 38.74197172, 38.74302531, 38.7440789, 38.74513249, 38.74618608, 38.74723967, 38.74829326, 38.74934685, 38.75040044, 38.75145403, 38.75250762, 38.75356121, 38.7546148, 38.75566839, 38.75672198, 38.75777557, 38.75882916, 38.75988275, 38.76093634, 38.76198993, 38.76304352, 38.76409711, 38.7651507, 38.76620429, 38.76725788, 38.76831147, 38.76936506, 38.77041865, 38.77147224, 38.77252583, 38.77357942, 38.77463301, 38.7756866, 38.77674019, 38.77779378, 38.77884737, 38.77990096, 38.78095455, \n38.78200814, 38.78306173, 38.78411532, 38.78516891, 38.7862225, 38.78727609, 38.78832968, 38.78938327, 38.79043686, 38.79149045, 38.79254404, 38.79359763, 38.79465122, 38.79570481, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, \n38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, \n38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, \n38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.7967584, 38.79570481, 38.79465122, 38.79359763, 38.79254404, 38.79149045, 38.79043686, 38.78938327, 38.78832968, 38.78727609, 38.7862225, 38.78516891, 38.78411532, 38.78306173, 38.78200814, 38.78095455, \n38.77990096, 38.77884737, 38.77779378, 38.77674019, 38.7756866, 38.77463301, 38.77357942, 38.77252583, 38.77147224, 38.77041865, 38.76936506, 38.76831147, 38.76725788, 38.76620429, 38.7651507, 38.76409711, 38.76304352, 38.76198993, 38.76093634, 38.75988275, 38.75882916, 38.75777557, 38.75672198, 38.75566839, 38.7546148, 38.75356121, 38.75250762, 38.75145403, 38.75040044, 38.74934685, 38.74829326, 38.74723967, 38.74618608, 38.74513249, 38.7440789, 38.74302531, 38.74197172, 38.74091813, 38.73986454, \n38.73881095, 38.73775736, 38.73670377, 38.73565018, 38.73459659, 38.733543, 38.73248941, 38.73143582, 38.73038223, 38.72932864, 38.72827505, 38.72722146, 38.72616787, 38.72511428, 38.72406069, 38.7230071, 38.72195351, 38.72089992, 38.71984633, 38.71879274, 38.71773915, 38.71668556, 38.71563197, 38.71457838, 38.71352479, 38.7124712, 38.71141761, 38.71036402, 38.70931043, 38.70825684, 38.70720325, 38.70614966, 38.70509607, 38.70404248, 38.70298889, 38.7019353, 38.70088171, 38.69982812, 38.69877453, \n38.69772094, 38.69666735, 38.69561376, 38.69456017, 38.69350658, 38.69245299, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, \n38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, \n38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, \n38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994, 38.6913994))<\/nobr><\/td><\/tr><\/table><\/div>",null,"2997",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],"sf_linestring",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[38.712520000084,38.7136300001706],"lng":[-9.13430999956965,-9.13403000008549]},"fitBounds":[38.712520000084,-9.13430999956965,38.7136300001706,-9.13403000008549,[]]},"evals":[],"jsHooks":[]}</script><p>Imagine you want to calculate the gradient of the route shown above. You can do this as a two step process as follows.</p>
<p><strong>Step 1</strong>: add elevations to each coordinate in the linestring (requires a <a href="https://account.mapbox.com/access-tokens/">MapBox API</a> key):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sf_linestring_xyz</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span> <span class="co"># dem = NULL</span>
<span class="co">#&gt; Loading required namespace: ceramic</span>
<span class="co">#&gt; Preparing to download: 9 tiles at zoom = 18 from </span>
<span class="co">#&gt; https://api.mapbox.com/v4/mapbox.terrain-rgb/</span></code></pre></div>
<p>With the argument <code>dem = NULL</code>, the function downloads the necessary elevation information from Mapbox. You can use this argument with a local digital elevation model (<code>dem = ...</code>).</p>
<p>You can check the elevations added to the new <code>sf_linestring_xyz</code> object by printing its coordinates, as follows (note the new Z column that goes from above 87 m above sea level to only 79 m in a short distance).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span>
<span class="co">#&gt;               X         Y    Z L1</span>
<span class="co">#&gt;  [1,] -87064.34 -105506.3 88.0  1</span>
<span class="co">#&gt;  [2,] -87065.47 -105514.3 87.7  1</span>
<span class="co">#&gt;  [3,] -87066.60 -105522.3 86.3  1</span>
<span class="co">#&gt;  [4,] -87067.73 -105530.3 86.3  1</span>
<span class="co">#&gt;  [5,] -87068.86 -105538.2 86.2  1</span>
<span class="co">#&gt;  [6,] -87069.99 -105546.2 84.4  1</span>
<span class="co">#&gt;  [7,] -87075.24 -105548.4 83.1  1</span>
<span class="co">#&gt;  [8,] -87080.48 -105550.5 81.5  1</span>
<span class="co">#&gt;  [9,] -87080.06 -105560.1 80.8  1</span>
<span class="co">#&gt; [10,] -87079.65 -105569.6 79.8  1</span>
<span class="co">#&gt; [11,] -87079.23 -105579.2 78.5  1</span>
<span class="co">#&gt; [12,] -87078.81 -105588.8 77.7  1</span>
<span class="co">#&gt; [13,] -87078.39 -105598.3 76.4  1</span>
<span class="co">#&gt; [14,] -87069.73 -105601.7 80.0  1</span>
<span class="co">#&gt; [15,] -87068.93 -105608.4 79.5  1</span>
<span class="co">#&gt; [16,] -87068.14 -105615.1 78.5  1</span>
<span class="co">#&gt; [17,] -87067.34 -105621.7 77.6  1</span>
<span class="co">#&gt; [18,] -87062.16 -105625.7 79.5  1</span>
<span class="co">#&gt; [19,] -87056.99 -105629.6 79.8  1</span></code></pre></div>
<p>You can use the <code>z_</code> functions to extract such values:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/z_value.html">z_value</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># returns all the elevation values between xy coordinates</span>
<span class="co">#&gt;  [1] 88.0 87.7 86.3 86.3 86.2 84.4 83.1 81.5 80.8 79.8 78.5 77.7 76.4 80.0 79.5</span>
<span class="co">#&gt; [16] 78.5 77.6 79.5 79.8</span>

<span class="fu"><a href="../reference/z_value.html">z_mean</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># elevation mean value</span>
<span class="co">#&gt; [1] 81.66316</span>
<span class="fu"><a href="../reference/z_value.html">z_min</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># elevation min value </span>
<span class="co">#&gt; [1] 88</span>
<span class="fu"><a href="../reference/z_value.html">z_max</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># elevation max value </span>
<span class="co">#&gt; [1] 88</span>
<span class="fu"><a href="../reference/z_value.html">z_start</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># first z</span>
<span class="co">#&gt; [1] 88</span>
<span class="fu"><a href="../reference/z_value.html">z_end</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span> <span class="co"># last z</span>
<span class="co">#&gt; [1] 79.8</span></code></pre></div>
<p><strong>Step 2</strong>: calculate the average slope of the linestring</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/slope_xyz.html">slope_xyz</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span>
<span class="co">#&gt;         1 </span>
<span class="co">#&gt; 0.1394946</span></code></pre></div>
<p>The result, just over 0.2, tells us that it’s quite a steep slope: a 21% gradient <em>on average</em>.</p>
</div>
<div id="route-available-dem" class="section level3">
<h3 class="hasAnchor">
<a href="#route-available-dem" class="anchor"></a>Route + available DEM</h3>
<p>Using the slopes package we can estimate the gradient of individual road segments. When these segments are combined into routes, we then need a means of assessing the hilliness of the entire route. A range of indices can be used to represent route hilliness. The choice of which index is most appropriate may be context dependent (see the <a href="https://itsleeds.github.io/intro-to-slopes/">introducion to slopes</a> vignette).</p>
<p>Again, let us use the same function with a entire route, <code>lisbon_route</code>, also available in the package:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sf_route</span> <span class="op">=</span> <span class="va">lisbon_route</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sf_route</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">sf_route</span><span class="op">)</span>
<span class="co">#&gt; [1] LINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">sf_route</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html">tm_lines</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_tiles.html">tm_basemap</a></span><span class="op">(</span><span class="fu">leaflet</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/leaflet/man/providers.html">providers</a></span><span class="op">$</span><span class="va">Esri.WorldTopoMap</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-af19de5c40092cf43f23" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-af19de5c40092cf43f23">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolylines","args":[[[[{"lng":[-9.14717991738062,-9.14717199992202,-9.14715799985797,-9.14714399982445,-9.14712999982144,-9.1472174997564,-9.14730499970212,-9.14731380787996,-9.14730499970212,-9.1472174997564,-9.14712999982144,-9.14706499996914,-9.14700000012511,-9.14689500008036,-9.14679000006281,-9.14669399992219,-9.14659799981199,-9.14650199973218,-9.14640599968279,-9.14630999966381,-9.14621000010468,-9.14610000002879,-9.14598999999666,-9.14598999999666,-9.1459499998137,-9.14587999993334,-9.14581000007159,-9.14570500001951,-9.14560000000932,-9.14550000011544,-9.14540000025688,-9.14530000043365,-9.14526000025069,-9.1451766668059,-9.14509333339082,-9.14501000000543,-9.14501000000543,-9.14494999973097,-9.1448649997742,-9.14477999985166,-9.14467000024681,-9.1446099999727,-9.14454999969791,-9.14446499976485,-9.1443799998186,-9.14426999982541,-9.14415999979167,-9.14404999971739,-9.14393999960255,-9.14393999960255,-9.1438549996754,-9.14376999972324,-9.143739999586,-9.14365499965885,-9.14356999970669,-9.14346999971328,-9.14336999969014,-9.1432999998293,-9.14322999994806,-9.14318999976507,-9.14314000043469,-9.14314000043469,-9.14310000023218,-9.14306000006875,-9.14297999970281,-9.14297999970281,-9.14293000037239,-9.14287000009796,-9.14287000009796,-9.14278250012157,-9.14269500016204,-9.14260750021938,-9.14252000029357,-9.14247000006486,-9.14241499979817,-9.14235999956169,-9.14232000027703,-9.14225499996648,-9.14218999968237,-9.14216000044347,-9.142140000352,-9.14212000026048,-9.14210000016901,-9.14208000007753,-9.14205999998605,-9.1420499999403,-9.14203999989454,-9.14203999989454,-9.14203999989454,-9.14203199982055,-9.14202399976526,-9.14201599972867,-9.14200799971078,-9.14199999971158,-9.14199999971159,-9.14199999971158,-9.1419999997112,-9.14199999971159,-9.14199142830526,-9.14198285692123,-9.14197428555949,-9.14196571422004,-9.14195714290289,-9.14194857160802,-9.14194000033545,-9.1419400003349,-9.14194000033545,-9.14194000033545,-9.14194666691574,-9.14195333348289,-9.1419600000369,-9.14196666657777,-9.14197333310551,-9.1419799996201,-9.14198333297385,-9.14198666632242,-9.14198999966583,-9.14199999971158,-9.14200499973781,-9.14200999975731,-9.14200999975645,-9.1420099997573,-9.1420099997573,-9.14191399988202,-9.1418179999943,-9.14172200009416,-9.1416260001816,-9.1415300002566,-9.14144000014588,-9.14135000003363,-9.14125999991986,-9.14114999985932,-9.14103999981184,-9.14094399993655,-9.14084800004883,-9.14075200014869,-9.14065600023613,-9.14056000031114,-9.14045999985371,-9.14037000034034,-9.14032000011163,-9.14020999960845,-9.14016000027804,-9.14013000014084,-9.14010000000361,-9.14006999986638,-9.14006999986638,-9.14005999982062,-9.14001999963766,-9.14000000044448,-9.13998000035301,-9.13997000030725,-9.13995000021577,-9.13994000017002,-9.13992000007854,-9.13992000007854,-9.13991000003278,-9.13988999994131,-9.13985999980407,-9.13983999971259,-9.13982999966687,-9.13981999962112,-9.13980999957536,-9.13980000042794,-9.1397700002907,-9.13974000015347,-9.13971000001627,-9.13966999983328,-9.13962999965032,-9.13960000041139,-9.13956000022843,-9.13950999999973,-9.1394399996795,-9.13939000034912,-9.13935000016613,-9.13929999993742,-9.13922999961723,-9.13918000028682,-9.13910999996663,-9.13904999969216,-9.13897000022455,-9.13889999990436,-9.13889999990436,-9.13880000034524,-9.13869000021513,-9.13858000001139,-9.13846999973404,-9.1383799998582,-9.13828999992456,-9.13819999993314,-9.13810999988393,-9.13804999960947,-9.13799000023333,-9.13790750015123,-9.13782500002199,-9.13774249984562,-9.13765999962213,-9.13757499975538,-9.13748999984002,-9.13740499987606,-9.1373199998635,-9.13725999958904,-9.13714999998419,-9.13704666685562,-9.13694333364849,-9.13684000036279,-9.13674000027153,-9.13664000011354,-9.13653999988883,-9.13646999956864,-9.13645000037546,-9.13640000014675,-9.13637000000951,-9.13626333353497,-9.13615666697925,-9.13605000034237,-9.13593999983922,-9.13588500004852,-9.13583000023434,-9.1357749999945,-9.13571999973116,-9.13564000026355,-9.13563000021779,-9.13559000003484,-9.13548333356029,-9.13537666700458,-9.13527000036769,-9.13516999991027,-9.13516999991027,-9.13512500017245,-9.1350800003969,-9.13500000003095,-9.13493999975649,-9.13493999975649,-9.13490999998117,-9.13488000014338,-9.13485000024312,-9.13482250020389,-9.13479500010696,-9.13476749995232,-9.13473999973998,-9.13470666657062,-9.13467333333457,-9.13464000003182,-9.13460666666239,-9.13457333322626,-9.13453999972343,-9.13445000021006,-9.13436333323764,-9.13427666634872,-9.1341899995433,-9.13410333282139,-9.13401666618297,-9.13392999962806,-9.13390000038913,-9.13380999997746,-9.13371999979833,-9.13362999970583,-9.13353999969998,-9.13344999978077,-9.13335999994821,-9.13327000020229,-9.13316999989536,-9.13306999970789,-9.13296999963988,-9.13286999969134,-9.13276999986226,-9.13267000015265,-9.13258999978671,-9.1324883332268,-9.13238666661782,-9.13228499995979,-9.1321833332527,-9.13208166649655,-9.13197999969135,-9.13206999963962,-9.13215999965349,-9.13224999973295,-9.13233999987799,-9.13243000008863,-9.13252000036485,-9.13252000036485,-9.13262400010783,-9.13272799994769,-9.13283199988442,-9.13293599991803,-9.13304000004851,-9.13302000022004,-9.13300000034668,-9.13298000042843,-9.13296000046527,-9.13294000045722,-9.13292000040428,-9.13290000030644,-9.13290000030644,-9.13288600029551,-9.13287200025802,-9.13285800019398,-9.13284400010339,-9.13282999998624,-9.13282999998624,-9.13284000000886,-9.1328500000546,-9.13286000012348,-9.13284000003197,-9.13276000013247,-9.13268000019841,-9.13261999992394,-9.13259999983246,-9.13258999978671,-9.13258999978671,-9.13258999978671,-9.13258999978671,-9.13259999983246,-9.13261999992394,-9.1326299999697,-9.13271333341699,-9.13279666683207,-9.13288000021495,-9.13288000021495,-9.13296999972832,-9.13300999991128,-9.13301999995704,-9.13302999998984,-9.13304000004851,-9.13301999995704,-9.13301999995704,-9.1330800002315,-9.13312999956188,-9.13317999981159,-9.1332300000193,-9.1332300000193,-9.13325000011081,-9.133320000431,-9.13339500033067,-9.13347000021884,-9.13347000021884,-9.13358000028164,-9.13369000032686,-9.13378500031971,-9.13388000029765,-9.13396999981102,-9.13403000008549,-9.13403000008549,-9.13408999988168,-9.13414999973609,-9.13415999976403,-9.13416999980976,-9.13417999987329,-9.13428000033075,-9.13428600014529,-9.13429199997645,-9.13429799982423,-9.13430399968863,-9.13430999956965,-9.13424999976135,-9.13418999991905,-9.13417799990922,-9.13416599987686,-9.13415399982196,-9.13414199974454,-9.13412999964458,-9.13412999964458,-9.13402666640099,-9.13392333319386,-9.13382000002319,-9.13379999993171,-9.13375999974875,-9.13371999956577,-9.13371999956577,-9.13363249962596,-9.13354499967863,-9.13345749972379,-9.13336999976142,-9.13336999976142],"lat":[38.7112538492621,38.7112120001231,38.7111380001599,38.7110640001937,38.7109900002245,38.7109950003043,38.7110000003185,38.711000503641,38.7110000003185,38.7109950003043,38.7109900002245,38.7109850002602,38.7109800002597,38.7109700003402,38.710960000326,38.7109480003774,38.7109360003496,38.7109240002424,38.710912000056,38.7108999997903,38.7108799998341,38.7108649999139,38.7108499998895,38.7108499998895,38.7108399999051,38.7108299999398,38.7108199999322,38.7108049999948,38.7107899999624,38.710776666722,38.7107633333955,38.710749999983,38.7107399999847,38.7107266667088,38.710713333373,38.7106999999774,38.7106999999774,38.710689999972,38.7106749999909,38.7106599999476,38.7106499999367,38.7106499999521,38.7106499999367,38.710654999973,38.7106599999476,38.7106725001105,38.7106850001704,38.7106975001273,38.7107099999812,38.7107099999812,38.7107200000138,38.710729999985,38.7107299999849,38.7107400000147,38.710749999983,38.7107600000218,38.7107699999755,38.7107799999898,38.7107899999624,38.7107899999624,38.7107699999755,38.7107699999755,38.7107349999837,38.7106999999774,38.7106499999367,38.7106499999367,38.710609999879,38.7105699997989,38.7105699997989,38.7105624998788,38.710554999893,38.7105474998414,38.7105399997241,38.7105299996964,38.7105099999976,38.7104900002725,38.7104700002017,38.7104550001616,38.710440000085,38.7104300000433,38.7104200000002,38.7104099999557,38.7103999999098,38.7103899998625,38.7103699997637,38.7103599997122,38.7103499996594,38.7103300002503,38.7103300002503,38.7102540001841,38.710178000116,38.7101020000462,38.7100259999747,38.7099499999014,38.7098799998013,38.7098199997611,38.7097699997887,38.7097199998158,38.7096357141678,38.7095514285177,38.7094671428655,38.7093828572112,38.7092985715548,38.7092142858963,38.7091300002357,38.7090700002421,38.709010000248,38.709010000248,38.7089283335561,38.7088466668629,38.7087650001684,38.7086833334726,38.7086016667755,38.7085200000771,38.7084466666983,38.7083733333186,38.708299999938,38.7082300003253,38.7081750001101,38.7081199998942,38.7080449998786,38.7079699998621,38.7079699998621,38.7079740000333,38.7079780001258,38.7079820001396,38.7079860000748,38.7079899999313,38.7079900000005,38.7079900000005,38.7079899999313,38.7079850001414,38.7079800002479,38.7079840004185,38.7079880005105,38.7079920005238,38.7079960004584,38.7080000003143,38.7080099999949,38.7080000003143,38.7080000003143,38.7080000003143,38.7079899999313,38.7079899999313,38.7079899999313,38.7080000003143,38.7080000003143,38.7080000003143,38.7080099999949,38.7080300000529,38.7080500001053,38.7080599997789,38.7080900001934,38.7081300002591,38.7081700003023,38.7081900003156,38.7082100003233,38.7082300003253,38.7082500003218,38.7082700003127,38.7082799999556,38.708299999938,38.7083199999149,38.7083599998519,38.7084300000383,38.7085099997668,38.7085599999022,38.7086400001863,38.7086900002307,38.7087400002402,38.7087900002147,38.7088400001543,38.7089099998707,38.7089500001786,38.7089899997631,38.7090300000262,38.709070000267,38.7091000002576,38.7091300002357,38.7091499999804,38.7091799999375,38.7091999996682,38.7091999996682,38.7092200000943,38.7092433335454,38.7092666668938,38.7092900001396,38.7093125001569,38.7093350001054,38.7093574999854,38.7093799997968,38.7093899999854,38.7094099996574,38.7094299997524,38.7094499997897,38.7094699997693,38.7094899996913,38.7095099999445,38.7095300001364,38.7095500002671,38.7095700003366,38.7095899999583,38.7096100002752,38.709636666969,38.7096633335724,38.7096900000854,38.7097133333652,38.7097366665603,38.7097599996706,38.70977999994,38.70977999994,38.7097900000726,38.7098000002038,38.7098266668327,38.7098533333652,38.7098799998013,38.7099000000372,38.7099149998712,38.7099299996795,38.7099449998577,38.7099600000103,38.7099800002238,38.7099800002238,38.7099900003284,38.7100166668864,38.710043333348,38.7100699997133,38.710089999896,38.710089999896,38.7101199998113,38.7101499997096,38.7102000001,38.7102399996861,38.7102399996861,38.7103166665325,38.710393333371,38.7104700002017,38.7105475001538,38.7106250000991,38.7107025000377,38.7107799999697,38.7108533332866,38.7109266665941,38.7109999998921,38.7110733331806,38.7111466664596,38.7112199997291,38.7111799999903,38.7111450002048,38.7111100003537,38.7110750004371,38.7110400004548,38.711005000407,38.7109700002936,38.710960000326,38.7109199997408,38.7108849999575,38.7108500001036,38.710815000179,38.7107800001838,38.7107450001178,38.7107099999813,38.7106666668906,38.7106233337125,38.7105800004469,38.7105366670938,38.7104933336533,38.7104500001253,38.7104500001253,38.7104666669491,38.710483333685,38.7105000003331,38.7105166668934,38.7105333333658,38.7105499997504,38.7105766666313,38.7106033334419,38.7106300001822,38.7106566668522,38.7106833334519,38.7107099999812,38.7107099999812,38.7107440001399,38.7107780002045,38.7108120001751,38.7108460000516,38.7108799998341,38.7109642855401,38.7110485712422,38.7111328569401,38.7112171426341,38.7113014283242,38.7113857140102,38.7114699996922,38.7114699996922,38.7115419997545,38.7116139998146,38.7116859998725,38.7117579999282,38.7118299999818,38.7118600002162,38.7119366667214,38.7120133332245,38.7120899997255,38.7121100000441,38.7121250001296,38.7121400001609,38.7121599997645,38.7121700002652,38.7121800000635,38.7121899998604,38.7121999996559,38.7121999996559,38.712210000151,38.7122199999437,38.7122199999437,38.7122066667093,38.7121933334159,38.7121800000635,38.7121800000635,38.7121700002652,38.7122400002258,38.712310000118,38.7123949998956,38.7124799996708,38.7125500000289,38.7125500000289,38.7126099998807,38.7126500002212,38.7126199999721,38.712589999702,38.712589999702,38.7125700002187,38.7125299998334,38.7125249999827,38.712520000084,38.712520000084,38.7125150002603,38.7125100003333,38.7125050001453,38.7124999998802,38.7125100003333,38.712520000084,38.712520000084,38.7125549999089,38.712589999702,38.7126499997052,38.7127099997068,38.7127699997066,38.7128000002474,38.7128860001694,38.7129720000897,38.7130580000082,38.7131439999249,38.7132299998399,38.7132499998519,38.7132699998335,38.7133419999045,38.7134139999737,38.7134860000411,38.7135580001067,38.7136300001706,38.7136300001706,38.7136166667648,38.713603333267,38.7135899996775,38.7135600001691,38.713510000026,38.7134300002851,38.7134300002851,38.7134325002887,38.7134350002269,38.7134375000997,38.713439999907,38.713439999907]}]]],"X1","sf_route",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#000000","weight":3,"opacity":1,"fill":false,"fillColor":"#000000","fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ID<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>sum_length<\/nobr><\/td><td align=\"right\"><nobr>2,519<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>pathfound<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>",null,"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],"sf_route",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[38.7079699998621,38.7136300001706],"lng":[-9.14731380787996,-9.13197999969135]},"fitBounds":[38.7079699998621,-9.14731380787996,38.7136300001706,-9.13197999969135,[]]},"evals":[],"jsHooks":[]}</script><p><strong>Step 1</strong>: add elevations to each coordinate in the route:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sf_route_xyz</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">sf_route</span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: ceramic</span>
<span class="co">#&gt; Preparing to download: 12 tiles at zoom = 15 from </span>
<span class="co">#&gt; https://api.mapbox.com/v4/mapbox.terrain-rgb/</span></code></pre></div>
<p><strong>Step 2</strong>: calculate the average slope of the route</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/slope_xyz.html">slope_xyz</a></span><span class="op">(</span><span class="va">sf_route_xyz</span><span class="op">)</span>
<span class="co">#&gt;          1 </span>
<span class="co">#&gt; 0.07681812</span></code></pre></div>
<p>The result shows a 7.7% gradient <em>on average</em>.</p>
<p>Now, if you already have a DEM, you can calculate the slopes directly as follows, with <code><a href="../reference/slope_raster.html">slope_raster()</a></code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="co">#&gt; [1] "RasterLayer"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "raster"</span>
<span class="fu"><a href="../reference/slope_raster.html">slope_raster</a></span><span class="op">(</span>routes <span class="op">=</span> <span class="va">sf_route</span>,
             dem <span class="op">=</span> <span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="co">#&gt;          1 </span>
<span class="co">#&gt; 0.07817098</span></code></pre></div>
<p>The result shows a 7.8% gradient <em>on average</em>. As you can see, the retrieved result from elevation information available in Mapbox and in this Digital Elevation Model, is quite similar. (See more about these differences in <a href="https://itsleeds.github.io/slopes/articles/verification.html">Verification of slopes</a>.)</p>
</div>
<div id="route-with-xyz-coordinates" class="section level3">
<h3 class="hasAnchor">
<a href="#route-with-xyz-coordinates" class="anchor"></a>Route with xyz coordinates</h3>
<p>If your linestring object already has X, Y and Z coordinates (e.g. from a GPS device), you can use the <code>slope_</code> functions directly.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># for a line xz</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">9</span><span class="op">)</span>
<span class="va">elevations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span>
<span class="fu"><a href="../reference/slope_vector.html">slope_vector</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">elevations</span><span class="op">)</span>
<span class="co">#&gt; [1]  0.05  0.00  0.20 -0.10 -0.05</span>

<span class="co"># for a path xyz</span>
<span class="va">xy</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="va">dist</span> <span class="op">=</span> <span class="fu"><a href="../reference/sequential_dist.html">sequential_dist</a></span><span class="op">(</span><span class="va">xy</span>, lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">elevations</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_extract.html">elevation_extract</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">dem_lisbon_raster</span><span class="op">)</span>

<span class="fu"><a href="../reference/slope_vector.html">slope_distance</a></span><span class="op">(</span><span class="va">dist</span>, <span class="va">elevations</span><span class="op">)</span>
<span class="co">#&gt;  [1] -0.047226259 -0.040883072 -0.025032918 -0.061124557 -0.017447060</span>
<span class="co">#&gt;  [6] -0.062426272 -0.123580541  0.033705378  0.004292243 -0.040360003</span>
<span class="co">#&gt; [11] -0.151671893 -0.182367906  0.409246854 -0.034463974 -0.098406640</span>
<span class="co">#&gt; [16] -0.161798173  0.076261379  0.100654228</span>
<span class="fu"><a href="../reference/slope_vector.html">slope_distance_mean</a></span><span class="op">(</span><span class="va">dist</span>, <span class="va">elevations</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.09283052</span>
<span class="fu"><a href="../reference/slope_vector.html">slope_distance_weighted</a></span><span class="op">(</span><span class="va">dist</span>, <span class="va">elevations</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.09501323</span></code></pre></div>
<p>In any case, to use the <code>slopes</code> package you need <strong>elevation points</strong>, either as a vector, a matrix or as a digital elevation model (DEM) encoded as a raster dataset.</p>
</div>
</div>
<div id="calculating-and-plotting-the-gradient-of-roads" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-and-plotting-the-gradient-of-roads" class="anchor"></a>Calculating and plotting the gradient of roads</h2>
<div id="road-network" class="section level3">
<h3 class="hasAnchor">
<a href="#road-network" class="anchor"></a>Road network</h3>
<p>Typical use cases for the package are calculating the slopes of geographic objects representing roads or other linear features. These two types of input data are represented in the code output and plot below.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A raster dataset included in the package:</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span> <span class="co"># digital elevation model</span>
<span class="co">#&gt; [1] "RasterLayer"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "raster"</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/getValues.html">values</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span><span class="op">)</span> <span class="co"># heights range from 0 to ~100m</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span>
<span class="co">#&gt;   0.000   8.598  30.233  33.733  55.691  97.906    4241</span>
<span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>

<span class="co"># A vector dataset included in the package:</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">lisbon_road_network</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">lisbon_road_network</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="slopes_files/figure-html/dem-lisbon-1.png" width="700"></p>
<p>Calculate the average gradient of <strong>each road segment</strong> as follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_road_network</span><span class="op">$</span><span class="va">slope</span> <span class="op">=</span> <span class="fu"><a href="../reference/slope_raster.html">slope_raster</a></span><span class="op">(</span><span class="va">lisbon_road_network</span>, dem <span class="op">=</span> <span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lisbon_road_network</span><span class="op">$</span><span class="va">slope</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt; 0.00000 0.01246 0.03534 0.05462 0.08251 0.27583</span></code></pre></div>
<p>This created a new column, <code>slope</code> that represents the average, distance weighted slope associated with each road segment. The units represent the percentage incline, that is the change in elevation divided by distance. The summary of the result tells us that the average gradient of slopes in the example data is just over 5%.</p>
<p>This result is equivalent to that returned by ESRI’s <code>Slope_3d()</code> in the <a href="https://desktop.arcgis.com/en/arcmap/10.3/tools/3d-analyst-toolbox/slope.htm">3D Analyst extension</a>, with a correlation between the ArcMap implementation and our implementation of more than 0.95 on our test dataset (we find higher correlations on larger datasets - see the <a href="https://itsleeds.github.io/slopes/articles/verification.html%20article">verification of slopes</a>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>
  <span class="va">lisbon_road_network</span><span class="op">$</span><span class="va">slope</span>,    <span class="co"># slopes calculates by the slopes package</span>
  <span class="va">lisbon_road_network</span><span class="op">$</span><span class="va">Avg_Slope</span> <span class="co"># slopes calculated by ArcMap's 3D Analyst extension</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 0.9770436</span></code></pre></div>
<p>We can now visualise the average slopes of each route calculated by the <code>slopes</code> package as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lisbon_road_network</span><span class="op">[</span><span class="st">"slope"</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="slopes_files/figure-html/slope-vis-1.png" width="700"></p>
</div>
<div id="elevation-profile" class="section level3">
<h3 class="hasAnchor">
<a href="#elevation-profile" class="anchor"></a>Elevation profile</h3>
<p>Taking the <a href="#route--available-dem">first route example</a>, imagine that we want to go from from the Santa Catarina area in the East of the map to the Castelo de São Jorge in the West. This route goes down a valley and up the other side:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(tmap)</span>
<span class="co"># tmap_mode("view")</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/qtm.html">qtm</a></span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f9a19b73f9a5ed450372" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-f9a19b73f9a5ed450372">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolylines","args":[[[[{"lng":[-9.14717991738062,-9.14717199992202,-9.14715799985797,-9.14714399982445,-9.14712999982144,-9.1472174997564,-9.14730499970212,-9.14731380787996,-9.14730499970212,-9.1472174997564,-9.14712999982144,-9.14706499996914,-9.14700000012511,-9.14689500008036,-9.14679000006281,-9.14669399992219,-9.14659799981199,-9.14650199973218,-9.14640599968279,-9.14630999966381,-9.14621000010468,-9.14610000002879,-9.14598999999666,-9.14598999999666,-9.1459499998137,-9.14587999993334,-9.14581000007159,-9.14570500001951,-9.14560000000932,-9.14550000011544,-9.14540000025688,-9.14530000043365,-9.14526000025069,-9.1451766668059,-9.14509333339082,-9.14501000000543,-9.14501000000543,-9.14494999973097,-9.1448649997742,-9.14477999985166,-9.14467000024681,-9.1446099999727,-9.14454999969791,-9.14446499976485,-9.1443799998186,-9.14426999982541,-9.14415999979167,-9.14404999971739,-9.14393999960255,-9.14393999960255,-9.1438549996754,-9.14376999972324,-9.143739999586,-9.14365499965885,-9.14356999970669,-9.14346999971328,-9.14336999969014,-9.1432999998293,-9.14322999994806,-9.14318999976507,-9.14314000043469,-9.14314000043469,-9.14310000023218,-9.14306000006875,-9.14297999970281,-9.14297999970281,-9.14293000037239,-9.14287000009796,-9.14287000009796,-9.14278250012157,-9.14269500016204,-9.14260750021938,-9.14252000029357,-9.14247000006486,-9.14241499979817,-9.14235999956169,-9.14232000027703,-9.14225499996648,-9.14218999968237,-9.14216000044347,-9.142140000352,-9.14212000026048,-9.14210000016901,-9.14208000007753,-9.14205999998605,-9.1420499999403,-9.14203999989454,-9.14203999989454,-9.14203999989454,-9.14203199982055,-9.14202399976526,-9.14201599972867,-9.14200799971078,-9.14199999971158,-9.14199999971159,-9.14199999971158,-9.1419999997112,-9.14199999971159,-9.14199142830526,-9.14198285692123,-9.14197428555949,-9.14196571422004,-9.14195714290289,-9.14194857160802,-9.14194000033545,-9.1419400003349,-9.14194000033545,-9.14194000033545,-9.14194666691574,-9.14195333348289,-9.1419600000369,-9.14196666657777,-9.14197333310551,-9.1419799996201,-9.14198333297385,-9.14198666632242,-9.14198999966583,-9.14199999971158,-9.14200499973781,-9.14200999975731,-9.14200999975645,-9.1420099997573,-9.1420099997573,-9.14191399988202,-9.1418179999943,-9.14172200009416,-9.1416260001816,-9.1415300002566,-9.14144000014588,-9.14135000003363,-9.14125999991986,-9.14114999985932,-9.14103999981184,-9.14094399993655,-9.14084800004883,-9.14075200014869,-9.14065600023613,-9.14056000031114,-9.14045999985371,-9.14037000034034,-9.14032000011163,-9.14020999960845,-9.14016000027804,-9.14013000014084,-9.14010000000361,-9.14006999986638,-9.14006999986638,-9.14005999982062,-9.14001999963766,-9.14000000044448,-9.13998000035301,-9.13997000030725,-9.13995000021577,-9.13994000017002,-9.13992000007854,-9.13992000007854,-9.13991000003278,-9.13988999994131,-9.13985999980407,-9.13983999971259,-9.13982999966687,-9.13981999962112,-9.13980999957536,-9.13980000042794,-9.1397700002907,-9.13974000015347,-9.13971000001627,-9.13966999983328,-9.13962999965032,-9.13960000041139,-9.13956000022843,-9.13950999999973,-9.1394399996795,-9.13939000034912,-9.13935000016613,-9.13929999993742,-9.13922999961723,-9.13918000028682,-9.13910999996663,-9.13904999969216,-9.13897000022455,-9.13889999990436,-9.13889999990436,-9.13880000034524,-9.13869000021513,-9.13858000001139,-9.13846999973404,-9.1383799998582,-9.13828999992456,-9.13819999993314,-9.13810999988393,-9.13804999960947,-9.13799000023333,-9.13790750015123,-9.13782500002199,-9.13774249984562,-9.13765999962213,-9.13757499975538,-9.13748999984002,-9.13740499987606,-9.1373199998635,-9.13725999958904,-9.13714999998419,-9.13704666685562,-9.13694333364849,-9.13684000036279,-9.13674000027153,-9.13664000011354,-9.13653999988883,-9.13646999956864,-9.13645000037546,-9.13640000014675,-9.13637000000951,-9.13626333353497,-9.13615666697925,-9.13605000034237,-9.13593999983922,-9.13588500004852,-9.13583000023434,-9.1357749999945,-9.13571999973116,-9.13564000026355,-9.13563000021779,-9.13559000003484,-9.13548333356029,-9.13537666700458,-9.13527000036769,-9.13516999991027,-9.13516999991027,-9.13512500017245,-9.1350800003969,-9.13500000003095,-9.13493999975649,-9.13493999975649,-9.13490999998117,-9.13488000014338,-9.13485000024312,-9.13482250020389,-9.13479500010696,-9.13476749995232,-9.13473999973998,-9.13470666657062,-9.13467333333457,-9.13464000003182,-9.13460666666239,-9.13457333322626,-9.13453999972343,-9.13445000021006,-9.13436333323764,-9.13427666634872,-9.1341899995433,-9.13410333282139,-9.13401666618297,-9.13392999962806,-9.13390000038913,-9.13380999997746,-9.13371999979833,-9.13362999970583,-9.13353999969998,-9.13344999978077,-9.13335999994821,-9.13327000020229,-9.13316999989536,-9.13306999970789,-9.13296999963988,-9.13286999969134,-9.13276999986226,-9.13267000015265,-9.13258999978671,-9.1324883332268,-9.13238666661782,-9.13228499995979,-9.1321833332527,-9.13208166649655,-9.13197999969135,-9.13206999963962,-9.13215999965349,-9.13224999973295,-9.13233999987799,-9.13243000008863,-9.13252000036485,-9.13252000036485,-9.13262400010783,-9.13272799994769,-9.13283199988442,-9.13293599991803,-9.13304000004851,-9.13302000022004,-9.13300000034668,-9.13298000042843,-9.13296000046527,-9.13294000045722,-9.13292000040428,-9.13290000030644,-9.13290000030644,-9.13288600029551,-9.13287200025802,-9.13285800019398,-9.13284400010339,-9.13282999998624,-9.13282999998624,-9.13284000000886,-9.1328500000546,-9.13286000012348,-9.13284000003197,-9.13276000013247,-9.13268000019841,-9.13261999992394,-9.13259999983246,-9.13258999978671,-9.13258999978671,-9.13258999978671,-9.13258999978671,-9.13259999983246,-9.13261999992394,-9.1326299999697,-9.13271333341699,-9.13279666683207,-9.13288000021495,-9.13288000021495,-9.13296999972832,-9.13300999991128,-9.13301999995704,-9.13302999998984,-9.13304000004851,-9.13301999995704,-9.13301999995704,-9.1330800002315,-9.13312999956188,-9.13317999981159,-9.1332300000193,-9.1332300000193,-9.13325000011081,-9.133320000431,-9.13339500033067,-9.13347000021884,-9.13347000021884,-9.13358000028164,-9.13369000032686,-9.13378500031971,-9.13388000029765,-9.13396999981102,-9.13403000008549,-9.13403000008549,-9.13408999988168,-9.13414999973609,-9.13415999976403,-9.13416999980976,-9.13417999987329,-9.13428000033075,-9.13428600014529,-9.13429199997645,-9.13429799982423,-9.13430399968863,-9.13430999956965,-9.13424999976135,-9.13418999991905,-9.13417799990922,-9.13416599987686,-9.13415399982196,-9.13414199974454,-9.13412999964458,-9.13412999964458,-9.13402666640099,-9.13392333319386,-9.13382000002319,-9.13379999993171,-9.13375999974875,-9.13371999956577,-9.13371999956577,-9.13363249962596,-9.13354499967863,-9.13345749972379,-9.13336999976142,-9.13336999976142],"lat":[38.7112538492621,38.7112120001231,38.7111380001599,38.7110640001937,38.7109900002245,38.7109950003043,38.7110000003185,38.711000503641,38.7110000003185,38.7109950003043,38.7109900002245,38.7109850002602,38.7109800002597,38.7109700003402,38.710960000326,38.7109480003774,38.7109360003496,38.7109240002424,38.710912000056,38.7108999997903,38.7108799998341,38.7108649999139,38.7108499998895,38.7108499998895,38.7108399999051,38.7108299999398,38.7108199999322,38.7108049999948,38.7107899999624,38.710776666722,38.7107633333955,38.710749999983,38.7107399999847,38.7107266667088,38.710713333373,38.7106999999774,38.7106999999774,38.710689999972,38.7106749999909,38.7106599999476,38.7106499999367,38.7106499999521,38.7106499999367,38.710654999973,38.7106599999476,38.7106725001105,38.7106850001704,38.7106975001273,38.7107099999812,38.7107099999812,38.7107200000138,38.710729999985,38.7107299999849,38.7107400000147,38.710749999983,38.7107600000218,38.7107699999755,38.7107799999898,38.7107899999624,38.7107899999624,38.7107699999755,38.7107699999755,38.7107349999837,38.7106999999774,38.7106499999367,38.7106499999367,38.710609999879,38.7105699997989,38.7105699997989,38.7105624998788,38.710554999893,38.7105474998414,38.7105399997241,38.7105299996964,38.7105099999976,38.7104900002725,38.7104700002017,38.7104550001616,38.710440000085,38.7104300000433,38.7104200000002,38.7104099999557,38.7103999999098,38.7103899998625,38.7103699997637,38.7103599997122,38.7103499996594,38.7103300002503,38.7103300002503,38.7102540001841,38.710178000116,38.7101020000462,38.7100259999747,38.7099499999014,38.7098799998013,38.7098199997611,38.7097699997887,38.7097199998158,38.7096357141678,38.7095514285177,38.7094671428655,38.7093828572112,38.7092985715548,38.7092142858963,38.7091300002357,38.7090700002421,38.709010000248,38.709010000248,38.7089283335561,38.7088466668629,38.7087650001684,38.7086833334726,38.7086016667755,38.7085200000771,38.7084466666983,38.7083733333186,38.708299999938,38.7082300003253,38.7081750001101,38.7081199998942,38.7080449998786,38.7079699998621,38.7079699998621,38.7079740000333,38.7079780001258,38.7079820001396,38.7079860000748,38.7079899999313,38.7079900000005,38.7079900000005,38.7079899999313,38.7079850001414,38.7079800002479,38.7079840004185,38.7079880005105,38.7079920005238,38.7079960004584,38.7080000003143,38.7080099999949,38.7080000003143,38.7080000003143,38.7080000003143,38.7079899999313,38.7079899999313,38.7079899999313,38.7080000003143,38.7080000003143,38.7080000003143,38.7080099999949,38.7080300000529,38.7080500001053,38.7080599997789,38.7080900001934,38.7081300002591,38.7081700003023,38.7081900003156,38.7082100003233,38.7082300003253,38.7082500003218,38.7082700003127,38.7082799999556,38.708299999938,38.7083199999149,38.7083599998519,38.7084300000383,38.7085099997668,38.7085599999022,38.7086400001863,38.7086900002307,38.7087400002402,38.7087900002147,38.7088400001543,38.7089099998707,38.7089500001786,38.7089899997631,38.7090300000262,38.709070000267,38.7091000002576,38.7091300002357,38.7091499999804,38.7091799999375,38.7091999996682,38.7091999996682,38.7092200000943,38.7092433335454,38.7092666668938,38.7092900001396,38.7093125001569,38.7093350001054,38.7093574999854,38.7093799997968,38.7093899999854,38.7094099996574,38.7094299997524,38.7094499997897,38.7094699997693,38.7094899996913,38.7095099999445,38.7095300001364,38.7095500002671,38.7095700003366,38.7095899999583,38.7096100002752,38.709636666969,38.7096633335724,38.7096900000854,38.7097133333652,38.7097366665603,38.7097599996706,38.70977999994,38.70977999994,38.7097900000726,38.7098000002038,38.7098266668327,38.7098533333652,38.7098799998013,38.7099000000372,38.7099149998712,38.7099299996795,38.7099449998577,38.7099600000103,38.7099800002238,38.7099800002238,38.7099900003284,38.7100166668864,38.710043333348,38.7100699997133,38.710089999896,38.710089999896,38.7101199998113,38.7101499997096,38.7102000001,38.7102399996861,38.7102399996861,38.7103166665325,38.710393333371,38.7104700002017,38.7105475001538,38.7106250000991,38.7107025000377,38.7107799999697,38.7108533332866,38.7109266665941,38.7109999998921,38.7110733331806,38.7111466664596,38.7112199997291,38.7111799999903,38.7111450002048,38.7111100003537,38.7110750004371,38.7110400004548,38.711005000407,38.7109700002936,38.710960000326,38.7109199997408,38.7108849999575,38.7108500001036,38.710815000179,38.7107800001838,38.7107450001178,38.7107099999813,38.7106666668906,38.7106233337125,38.7105800004469,38.7105366670938,38.7104933336533,38.7104500001253,38.7104500001253,38.7104666669491,38.710483333685,38.7105000003331,38.7105166668934,38.7105333333658,38.7105499997504,38.7105766666313,38.7106033334419,38.7106300001822,38.7106566668522,38.7106833334519,38.7107099999812,38.7107099999812,38.7107440001399,38.7107780002045,38.7108120001751,38.7108460000516,38.7108799998341,38.7109642855401,38.7110485712422,38.7111328569401,38.7112171426341,38.7113014283242,38.7113857140102,38.7114699996922,38.7114699996922,38.7115419997545,38.7116139998146,38.7116859998725,38.7117579999282,38.7118299999818,38.7118600002162,38.7119366667214,38.7120133332245,38.7120899997255,38.7121100000441,38.7121250001296,38.7121400001609,38.7121599997645,38.7121700002652,38.7121800000635,38.7121899998604,38.7121999996559,38.7121999996559,38.712210000151,38.7122199999437,38.7122199999437,38.7122066667093,38.7121933334159,38.7121800000635,38.7121800000635,38.7121700002652,38.7122400002258,38.712310000118,38.7123949998956,38.7124799996708,38.7125500000289,38.7125500000289,38.7126099998807,38.7126500002212,38.7126199999721,38.712589999702,38.712589999702,38.7125700002187,38.7125299998334,38.7125249999827,38.712520000084,38.712520000084,38.7125150002603,38.7125100003333,38.7125050001453,38.7124999998802,38.7125100003333,38.712520000084,38.712520000084,38.7125549999089,38.712589999702,38.7126499997052,38.7127099997068,38.7127699997066,38.7128000002474,38.7128860001694,38.7129720000897,38.7130580000082,38.7131439999249,38.7132299998399,38.7132499998519,38.7132699998335,38.7133419999045,38.7134139999737,38.7134860000411,38.7135580001067,38.7136300001706,38.7136300001706,38.7136166667648,38.713603333267,38.7135899996775,38.7135600001691,38.713510000026,38.7134300002851,38.7134300002851,38.7134325002887,38.7134350002269,38.7134375000997,38.713439999907,38.713439999907]}]]],"X1","lisbon_route",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#000000","weight":1,"opacity":1,"fill":false,"fillColor":"#000000","fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ID<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>sum_length<\/nobr><\/td><td align=\"right\"><nobr>2,519<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>pathfound<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>",null,"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"lisbon_route",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":false,"updateWhenIdle":true,"position":"bottomright"}]}],"limits":{"lat":[38.7079699998621,38.7136300001706],"lng":[-9.14731380787996,-9.13197999969135]},"fitBounds":[38.7079699998621,-9.14731380787996,38.7136300001706,-9.13197999969135,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null}]}}</script><p>We can convert the <code>lisbon_route</code> object into a 3d linestring object with X, Y and Z coordinates, using the elevation values stored in the DEM, as follows:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_route_xyz</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_route</span>, <span class="va">dem_lisbon_raster</span><span class="op">)</span> </code></pre></div>
<p>We can now visualise the elevation profile of the route as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz</span><span class="op">)</span></code></pre></div>
<p><img src="slopes_files/figure-html/plot_slope-1.png" width="700"></p>
</div>
<div id="using-elevation_add-with-and-without-a-dem-argument" class="section level3">
<h3 class="hasAnchor">
<a href="#using-elevation_add-with-and-without-a-dem-argument" class="anchor"></a>Using <code>elevation_add()</code> with and without a <code>dem =</code> argument</h3>
<p>If you do not have a raster dataset representing elevations, you can automatically download them by omitting the argument <code>dem = NULL</code> (a step that is automatically done in the function <code><a href="../reference/elevation_add.html">elevation_add()</a></code> shown in the basic example above, results of the subsequent code chunk not shown):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dem_mapbox</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_get.html">elevation_get</a></span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span>
<span class="va">lisbon_road_proj</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">lisbon_route</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">crs</a></span><span class="op">(</span><span class="va">dem_mapbox</span><span class="op">)</span><span class="op">)</span>
<span class="va">lisbon_route_xyz_mapbox</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_road_proj</span>, dem <span class="op">=</span> <span class="va">dem_mapbox</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz_mapbox</span><span class="op">)</span></code></pre></div>
<p>As outlined in the basic example above this can be done more concisely, as:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_route_xyz_auto</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span> <span class="co">#dem = NULL</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz_auto</span><span class="op">)</span></code></pre></div>
<p><img src="slopes_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>Note that the elevations shown in both plots differ, since the first is based on DEM elevation available, and the second is based in <em>Mapbox</em> elevation.</p>
</div>
</div>
<div id="commulative-elevation-change" class="section level2">
<h2 class="hasAnchor">
<a href="#commulative-elevation-change" class="anchor"></a>Commulative elevation change</h2>
<p>The following example calculate the elevations of a route in Leeds, and plots its commutative sum along the route (not evaluated).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cyclestreets_xyz</span> <span class="op">=</span> <span class="fu"><a href="../reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">cyclestreets_route</span><span class="op">)</span> 
<span class="fu"><a href="../reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">cyclestreets_xyz</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">cyclestreets_xyz</span><span class="op">$</span><span class="va">distances</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">cyclestreets_xyz</span><span class="op">$</span><span class="va">elevation_change</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="see-more-in-vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#see-more-in-vignettes" class="anchor"></a>See more in vignettes</h2>
<ul>
<li><a href="https://itsleeds.github.io/slopes/index.html">slopes package</a></li>
<li><a href="https://itsleeds.github.io/slopes/articles/intro-to-slopes.html">An introduction to slopes</a></li>
<li><a href="https://itsleeds.github.io/slopes/articles/roadnetworkcycling.html">Reproducible example: gradients of a road network for a given city</a></li>
<li><a href="https://itsleeds.github.io/slopes/articles/verification.html">Verification of slopes</a></li>
<li><a href="https://itsleeds.github.io/slopes/articles/benchmark.html">Benchmarking slopes calculation</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Joey Talbot, Rosa Félix.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

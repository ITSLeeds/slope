<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to slopes • slopes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to slopes">
<meta property="og:description" content="slopes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slopes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/slopes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark.html">Benchmarking slopes calculation</a>
    </li>
    <li>
      <a href="../articles/intro-to-slopes.html">An introduction to slopes</a>
    </li>
    <li>
      <a href="../articles/roadnetworkcycling.html">Example: gradients of a road network for a given city</a>
    </li>
    <li>
      <a href="../articles/verification.html">Verification of slopes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/slopes/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro-to-slopes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An introduction to slopes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/itsleeds/slopes/blob/master/vignettes/intro-to-slopes.Rmd"><code>vignettes/intro-to-slopes.Rmd</code></a></small>
      <div class="hidden name"><code>intro-to-slopes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/itsleeds/slopes/">slopes</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Although there are several ways to name “slope”, such as “steepness”, “hilliness”, “inclination”, “aspect”, “gradient”, “declivity”, the referred <code>slopes</code> in this package can be defined as the “longitudinal gradient” of linear geographic entities, as defined in the context of rivers by<span class="citation">(Cohen et al. 2018)</span>.</p>
<p>The package was initially developed to research road slopes to support evidence-based sustainable transport policies. Accounting for gradient when planning for new cycling infrastructure and road space reallocation for walking and cycling can improve outcomes, for example by helping to identify routes that avoid steep hills. The package can be used to calculate and visualise slopes of rivers and trajectories representing movement on roads of the type published as open data by <span class="citation">Ariza-López et al. (2019)</span>.</p>
<p>Data on slopes are useful in many fields of research, including <a href="https://en.wikipedia.org/wiki/Stream_gradient">hydrology</a>, natural hazards (including <a href="https://www.humanitarianresponse.info/fr/operations/afghanistan/infographic/afg-river-gradient-and-flood-hazard">flooding</a> and <a href="https://assets.publishing.service.gov.uk/media/57a08d0740f0b652dd0016f4/R7815-ADD017_col.pdf">landslide risk management</a>), recreational and competitive sports such as <a href="http://theclimbingcyclist.com/gradients-and-cycling-an-introduction/">cycling</a>, <a href="https://trailism.com/trail-grades/">hiking</a>, and <a href="https://www.snowplaza.co.uk/blog/16682-skiing-steeps-what-does-gradient-mean-ski-piste/">skiing</a>. Slopes are also also important in some branches of <a href="https://www.sciencedirect.com/science/article/pii/S2352146516302642">transport and emissions modelling</a> and <a href="https://doi.org/10.1016/j.ncon.2016.10.001">ecology</a>. A growing number of people working with geospatial data require accurate estimates of gradient, including:</p>
<ul>
<li>Transport planning practitioners who require accurate estimates of roadway gradient for estimating energy consumption, safety and mode shift potential in hilly cities (such as Lisbon, the case study city used in the examples in the documentation).</li>
<li>Vehicle routing software developers, who need to build systems are sensitive to going up or down steep hills (e.g. bicycles, trains, and large trucks), such as active travel planning, logistics, and emergency services.</li>
<li>Natural hazard researchers and risk assessors require estimates of linear gradient to inform safety and mitigation plans associated with project on hilly terrain.</li>
<li>Aquatic ecologists, flooding researchers and others, who could benefit from estimates of river gradient to support modelling of storm hydrographs</li>
</ul>
<p>There likely other domains where slopes could be useful, such as agriculture, geology, and civil engineering.</p>
<p>An example of the demand for data provided by the package is a map showing gradients across Sao Paulo (Brazil, see image below) that has received more than 300 ‘likes’ on Twitter and generated conversations: <a href="https://twitter.com/DanielGuth/status/1347270685161304069" class="uri">https://twitter.com/DanielGuth/status/1347270685161304069</a></p>
<p><img src="https://camo.githubusercontent.com/30a3b814dd72aef5b51db635f2ab6e1b6b6c57b856d239822788967a4932d655/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f45724a32647238574d414948774d6e3f666f726d61743d6a7067266e616d653d6c61726765" style="width:50.0%"></p>
</div>
<div id="calculating-slopes" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-slopes" class="anchor"></a>Calculating slopes</h2>
<p>The most common slope calculation method is defined by the vertical difference of the final and start point or line height (z1 and z0) divided by the horizontal length that separates them.</p>
<p><span class="math display">\[
s = \Delta z/l
\]</span></p>
<p>Depending on the purpose of application, it might me relevant to understand how hilliness is estimated.</p>
<div class="figure">
<img src="https://sinalnorte.com/wp-content/uploads/2018/02/A3b.jpg" style="width:10.0%" alt=""><p class="caption">Traffic sign</p>
</div>
<div id="measures-of-route-hilliness" class="section level3">
<h3 class="hasAnchor">
<a href="#measures-of-route-hilliness" class="anchor"></a>Measures of route hilliness</h3>
<p>There are many ways to measure hilliness, mean distance weighted hilliness being perhaps the most common. These measures, and their implementation (or current lack thereof) in the package is summarised below.</p>
<ul>
<li><p><strong>Mean distance weighted gradient</strong>. Perhaps the simplest and most widely applicable measure is the mean gradient of the route. This should be weighted by the distance of each segment. Implemented by default in the <code><a href="../reference/slope_raster.html">slope_raster()</a></code> function.</p></li>
<li><p><strong>Max gradient</strong>. For activities like cycling, where steep hills have a disproportionate impact, it may be useful to consider the maximum gradient. Not yet implemented.</p></li>
</ul>
<!-- Todo: update when we have `method = max` --><ul>
<li><p><strong>Xth percentile gradient</strong>. Since the maximum gradient gives no information about the rest of the route segments, other measures such as the 75th percentile gradient could be more informative. Not yet implemented.</p></li>
<li><p><strong>Inverted harmonic mean</strong>. If we use the following formula we will get an index that (like the arithmetic mean) makes use of the full dataset, but that is weighted towards the higher gradient segments. Whether this index, the formula of which is shown below, is helpful, remains to be tested. Not yet implemented.</p></li>
</ul>
<p><span class="math display">\[
H(x) = 1 - distance.weighted.harmonic.mean(1-x)
\]</span></p>
</div>
<div id="segments-in-a-route-cumulative-slope" class="section level3">
<h3 class="hasAnchor">
<a href="#segments-in-a-route-cumulative-slope" class="anchor"></a>Segments in a route: Cumulative slope</h3>
<p>The length of a segment in a route is also a relevant factor to have in consideration. If it is ok to bike through a segment of 8% with xx length, it is not so ok to bike in four segments in a row like that one (8% for 4xx length), as illustrated bellow.</p>
<div class="figure">
<img src="SLOPES-commulative-slope-1.png" alt="Illustration of the importance of slope length. 4 segments with an 8% gradient is not the same as a single segment with a gradient of 8%." width="40%"><p class="caption">
Illustration of the importance of slope length. 4 segments with an 8% gradient is not the same as a single segment with a gradient of 8%.
</p>
</div>
<p>This is accounted for in slope calculation methods that take the distance-weighted mean of slopes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">9</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span><span class="op">)</span>
<span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/sequential_dist.html">sequential_dist</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">slopes</span><span class="fu">::</span><span class="fu"><a href="../reference/slope_vector.html">slope_distance_weighted</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, elevations <span class="op">=</span> <span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.04040715</span>
<span class="fu">slopes</span><span class="fu">::</span><span class="fu"><a href="../reference/slope_vector.html">slope_distance_mean</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, elevations <span class="op">=</span> <span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.07406138</span></code></pre></div>
<p>The slope estimate that results from the distance-weighted mean is lower than the simple mean. This is common: steep slopes tend to be short!</p>
<p>A graphical representation of the scenario demonstrated above is shown in Figure @ref(fig:weighted), that shows the relatively long and flat final segment reduces the slope by half.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span>
<span class="op">(</span><span class="va">gxy</span> <span class="op">=</span> <span class="fu"><a href="../reference/slope_matrix.html">slope_matrix</a></span><span class="op">(</span><span class="va">m</span>, lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1]  0.05000000  0.00000000  0.20000000 -0.10000000 -0.02030692</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span>, <span class="va">gxy</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Distance elevation profile"</span>,
  sub <span class="op">=</span> <span class="st">"Points show calculated gradients of subsequent lines"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="intro-to-slopes_files/figure-html/weighted-1.png" alt="Illustration of example data that demonstrates distance-weighted mean gradient, used by default in the slopes package." width="700"><p class="caption">
Illustration of example data that demonstrates distance-weighted mean gradient, used by default in the slopes package.
</p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-ariza-lopez_dataset_2019">
<p>Ariza-López, Francisco Javier, Antonio Tomás Mozas-Calvache, Manuel Antonio Ureña-Cámara, and Paula Gil de la Vega. 2019. “Dataset of Three-Dimensional Traces of Roads.” <em>Scientific Data</em> 6 (1): 1–10. <a href="https://doi.org/10.1038/s41597-019-0147-x">https://doi.org/10.1038/s41597-019-0147-x</a>.</p>
</div>
<div id="ref-cohen_global_2018">
<p>Cohen, Sagy, Tong Wan, Md Tazmul Islam, and J. P. M. Syvitski. 2018. “Global River Slope: A New Geospatial Dataset and Global-Scale Analysis.” <em>Journal of Hydrology</em> 563 (August): 1057–67. <a href="https://doi.org/10.1016/j.jhydrol.2018.06.066">https://doi.org/10.1016/j.jhydrol.2018.06.066</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Joey Talbot, Rosa Félix.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

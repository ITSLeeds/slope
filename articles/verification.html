<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verification of slopes • slopes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Verification of slopes">
<meta property="og:description" content="slopes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slopes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/slopes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/verification.html">Verification of slopes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/slopes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="verification_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Verification of slopes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/itsleeds/slopes/blob/master/vignettes/verification.Rmd"><code>vignettes/verification.Rmd</code></a></small>
      <div class="hidden name"><code>verification.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This article aims to provide external verification of the results provided by the package. So far only one verification dataset has been used, but we hope to find others. If you know of verification datasets, please let us know — initially we planned to use a dataset from a paper on river slopes <span class="citation">(Cohen et al. 2018)</span>, but we could find no way of extracting the underlying data to do the calculation.</p>
<p>For this article we primarily used the following packages, although others are loaded in subsequent code chunks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/itsleeds/slopes">slopes</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://r-spatial.github.io/sf">sf</a></span>)
<span class="co">#&gt; Linking to GEOS 3.7.1, GDAL 2.2.3, PROJ 4.9.3</span>
</pre></div>
<p>The results are reproducible (requires downloading input data manually and installing additional packages). To keep package build times low, only the results are presented below.</p>
</div>
<div id="comparison-with-results-from-arcmap-3d-analyst" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-results-from-arcmap-3d-analyst" class="anchor"></a>Comparison with results from ArcMap 3D Analyst</h1>
</div>
<div id="three-dimensional-traces-of-roads-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#three-dimensional-traces-of-roads-dataset" class="anchor"></a>Three-dimensional traces of roads dataset</h1>
<!-- todo: make the segments -->
<p>An input dataset, comprising a 3D linestring recorded using a dual frequency GNSS receiver (a <a href="https://gef.nerc.ac.uk/equipment/gnss/1200/1200_overview.php">Leica 1200</a>) with a vertical accuracy of 20 mm <!-- 138 GPS 3D traces of a hilly road from a peer reviewed journal article --> <span class="citation">(Ariza-López et al. 2019)</span> was downloaded from the <!-- [figshare website as a .zip file](https://ndownloader.figshare.com/files/14331197) - raw data --> <a href="https://ndownloader.figshare.com/files/14331185">figshare website as a .zip file</a> and unzipped and inflated in the working directory as follows (not evaluated to reduce package build times):</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="st">"https://ndownloader.figshare.com/files/14331185"</span>, <span class="st">"3DGRT_AXIS_EPSG25830_v2.zip"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span>(<span class="st">"3DGRT_AXIS_EPSG25830_v2.zip"</span>)
<span class="kw">trace</span> <span class="op">=</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">read_sf</a></span>(<span class="st">"3DGRT_AXIS_EPSG25830_v2.shp"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">trace</span>)
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">trace</span>)
<span class="co">#&gt; 11304</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">trace</span><span class="op">$</span><span class="kw">X3DGRT_h</span>)
<span class="co">#&gt;  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   642.9   690.3   751.4   759.9   834.3   884.9 </span>
</pre></div>
<p>To verify our estimates of hilliness, we generated slope estimates for each segment and compared them with <a href="https://www.nature.com/articles/s41597-019-0147-x/tables/7">Table 7</a> in <span class="citation">Ariza-López et al. (2019)</span>. The absolute gradient measure published in that paper were:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">res_gps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.00</span>, <span class="fl">4.58</span>, <span class="fl">1136.36</span>, <span class="fl">6.97</span>)
<span class="kw">res_final</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.00</span>, <span class="fl">4.96</span>, <span class="fl">40.70</span>, <span class="fl">3.41</span>)
<span class="kw">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GPS"</span>, <span class="st">"Dual frequency GNSS receiver"</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="kw">res_gps</span>, <span class="kw">res_final</span>)
))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">res</span>) <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Source"</span>, <span class="st">"min"</span>, <span class="st">" mean"</span>, <span class="st">" max"</span>, <span class="st">" stdev"</span>)
<span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">res</span>, row.names = <span class="fl">FALSE</span>)
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Source</th>
<th align="left">min</th>
<th align="left">mean</th>
<th align="left">max</th>
<th align="left">stdev</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GPS</td>
<td align="left">0</td>
<td align="left">4.58</td>
<td align="left">1136.36</td>
<td align="left">6.97</td>
</tr>
<tr class="even">
<td align="left">Dual frequency GNSS receiver</td>
<td align="left">0</td>
<td align="left">4.96</td>
<td align="left">40.7</td>
<td align="left">3.41</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># mapview::mapview(trace) # check extent: it's above 6km in height</span>
<span class="co"># remotes::install_github("hypertidy/ceramic")</span>
<span class="kw">loc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(<span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_coordinates.html">st_coordinates</a></span>(<span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="kw">trace</span>, <span class="fl">4326</span>)))
<span class="kw">e</span> <span class="op">=</span> <span class="kw">ceramic</span>::<span class="fu"><a href="https://rdrr.io/pkg/ceramic/man/cc_location.html">cc_elevation</a></span>(loc = <span class="kw">loc</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>], buffer = <span class="fl">3000</span>)
<span class="kw">trace_projected</span> <span class="op">=</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_transform</a></span>(<span class="kw">trace</span>, <span class="fl">3857</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">e</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">trace_projected</span><span class="op">$</span><span class="kw">geometry</span>, add = <span class="fl">TRUE</span>)
</pre></div>
<p><img src="https://user-images.githubusercontent.com/1825120/81125221-75c06780-8f2f-11ea-8cea-ad6322ef99e7.png"><!-- --></p>
<p>The slopes were estimated as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># source: https://www.robinlovelace.net/presentations/munster.html#31</span>
<span class="kw">points2line_trajectory</span> <span class="op">=</span> <span class="fu">function</span>(<span class="kw">p</span>) {
  <span class="kw">c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_coordinates.html">st_coordinates</a></span>(<span class="kw">p</span>)
  <span class="kw">i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p</span>) <span class="op">-</span> <span class="fl">2</span>)
  <span class="kw">l</span> <span class="op">=</span> <span class="kw">purrr</span>::<span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(<span class="kw">i</span>, <span class="op">~</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st.html">st_linestring</a></span>(<span class="kw">c</span>[<span class="kw">.x</span><span class="op">:</span>(<span class="kw">.x</span> <span class="op">+</span> <span class="fl">1</span>), ]))
  <span class="kw">lfc</span> <span class="op">=</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/sfc.html">st_sfc</a></span>(<span class="kw">l</span>)
  <span class="kw">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">lfc</span>)) <span class="op">+</span> <span class="fl">1</span> <span class="co"># sequence to subset</span>
  <span class="kw">p_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_geometry.html">st_set_geometry</a></span>(<span class="kw">p</span>[<span class="kw">a</span>, ], <span class="kw">NULL</span>))
  <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/sf.html">st_sf</a></span>(<span class="kw">p_data</span>, geometry = <span class="kw">lfc</span>)
}
<span class="kw">r</span> <span class="op">=</span> <span class="fu">points2line_trajectory</span>(<span class="kw">trace_projected</span>)
<span class="co"># summary(st_length(r)) # mean distance is 1m! Doesn't make sense, need to create segments</span>
<span class="kw">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/slope_raster.html">slope_raster</a></span>(<span class="kw">r</span>, e = <span class="kw">e</span>)
<span class="kw">slope_summary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(min = <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">s</span>), mean = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">s</span>), max = <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">s</span>), stdev = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">s</span>))
<span class="kw">slope_summary</span> <span class="op">=</span> <span class="kw">slope_summary</span> <span class="op">*</span> <span class="fl">100</span>
<span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">slope_summary</span>, digits = <span class="fl">1</span>)
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">min</th>
<th align="right">mean</th>
<th align="right">max</th>
<th align="right">stdev</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0</td>
<td align="right">6.2</td>
<td align="right">48.2</td>
<td align="right">5.6</td>
</tr></tbody>
</table>
<p>Combined with the previous table from <span class="citation">Ariza-López et al. (2019)</span>, these results can be compared with those obtained from mainstream GPS, and an accurate GNSS receiver:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Source</th>
<th align="left">min</th>
<th align="left">mean</th>
<th align="left">max</th>
<th align="left">stdev</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GPS</td>
<td align="left">0</td>
<td align="left">4.58</td>
<td align="left">1136.36</td>
<td align="left">6.97</td>
</tr>
<tr class="even">
<td align="left">Dual frequency GNSS receiver</td>
<td align="left">0</td>
<td align="left">4.96</td>
<td align="left">40.7</td>
<td align="left">3.41</td>
</tr>
<tr class="odd">
<td align="left">Slopes R package</td>
<td align="left">0</td>
<td align="left">6.2</td>
<td align="left">48.2</td>
<td align="left">5.6</td>
</tr>
</tbody>
</table>
<p>It is notable that the package substantially overestimates the gradient, perhaps due to the low resolution of the underlying elevation raster. However, the slopes package seems to provide less noisy slope estimates than the GPS approach, with lower maximum values and low standard deviation.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-ariza-lopez_dataset_2019">
<p>Ariza-López, Francisco Javier, Antonio Tomás Mozas-Calvache, Manuel Antonio Ureña-Cámara, and Paula Gil de la Vega. 2019. “Dataset of Three-Dimensional Traces of Roads.” <em>Scientific Data</em> 6 (1): 1–10. <a href="https://doi.org/10.1038/s41597-019-0147-x">https://doi.org/10.1038/s41597-019-0147-x</a>.</p>
</div>
<div id="ref-cohen_global_2018">
<p>Cohen, Sagy, Tong Wan, Md Tazmul Islam, and J. P. M. Syvitski. 2018. “Global River Slope: A New Geospatial Dataset and Global-Scale Analysis.” <em>Journal of Hydrology</em> 563 (August): 1057–67. <a href="https://doi.org/10.1016/j.jhydrol.2018.06.066">https://doi.org/10.1016/j.jhydrol.2018.06.066</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Joey Talbot, Rosa Félix.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate Slopes of Roads, Rivers and Trajectories • slopes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calculate Slopes of Roads, Rivers and Trajectories">
<meta property="og:description" content="Functions and example data to support research into
  longitudinal gradient (slope) of linear geographic entities, as defined in the context of rivers
  by Cohen et al. (2018) &lt;doi:10.1016/j.jhydrol.2018.06.066&gt;.
  The package was initially developed to research road slopes but has also been
  used to calculate and visualise slopes of rivers and, using an open dataset
  published by Javier Ariza-López et al. (2019) &lt;doi:10.1038/s41597-019-0147-x&gt;, trajectories representing
  movement on roads.
  The package takes two main types of input data for slope calculation: vector geographic
  objects representing linear features, and raster geographic objects with elevation values
  (which can be downloaded using functionality in the package)
  representing a continuous terrain surface.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">slopes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/slopes.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/benchmark.html">Benchmarking slopes calculation</a>
    </li>
    <li>
      <a href="articles/roadnetworkcycling.html">Example: gradients of a road network for a given city</a>
    </li>
    <li>
      <a href="articles/verification.html">Verification of slopes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/slopes/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="slopes" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#slopes" class="anchor"></a>slopes</h1></div>
<!-- badges: start -->

<p>The <strong>slopes</strong> R package calculates the slope (longitudinal steepness, also known as gradient) of linear features such as roads and rivers, based on two main inputs:</p>
<ul>
<li>
<a href="https://geocompr.robinlovelace.net/spatial-class.html#vector-data">vector</a> linestring geometries defined by classes in the <a href="https://r-spatial.github.io/sf/"><code>sf</code> package</a>
</li>
<li>
<a href="https://geocompr.robinlovelace.net/spatial-class.html#raster-data">raster</a> objects with pixel values reporting average height, commonly known as digital elevation model (DEM) datasets, defined by classes in the <a href="https://cran.r-project.org/package=raster"><code>raster</code></a> or more recent <a href="https://rspatial.org/terra"><code>terra</code></a> packages</li>
</ul>
<p>This README covers installation and basic usage. For more information about slopes and how to use the package to calculate them, see the <a href="https://itsleeds.github.io/slopes/">slopes vignette</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the released version of slopes from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("slopes") -->
<!-- ``` -->
<p>Install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"itsleeds/slopes"</span><span class="op">)</span></code></pre></div>
<p>If you do not already have DEM data and want to make use of the package’s ability to download them using the <code>ceramic</code> package, install the package with suggested dependencies as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"itsleeds/slopes"</span>, dependencies <span class="op">=</span> <span class="st">"Suggests"</span><span class="op">)</span></code></pre></div>
<p>Furthermore, you will need to add a MapBox API key to be able to get DEM datasets, by signing up and registering for a key at <a href="https://account.mapbox.com/access-tokens/" class="uri">https://account.mapbox.com/access-tokens/</a> and then following these steps:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu">edit_r_environ</span><span class="op">(</span><span class="op">)</span>
<span class="co"># Type in (register on the mapbox website):</span>
<span class="va">MAPBOX_API_KEY</span><span class="op">=</span><span class="va">xxxxx</span></code></pre></div>
</div>
<div id="basic-example" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic example</h2>
<p>Load the package in the usual way:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/itsleeds/slopes/">slopes</a></span><span class="op">)</span></code></pre></div>
<p>We will also load the <code>sf</code> library:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="co">#&gt; Linking to GEOS 3.9.0, GDAL 3.2.1, PROJ 7.2.1</span></code></pre></div>
<p>The minimum input data requirement for using the package is an <code>sf</code> object containing LINESTRING geometries. You can check your input dataset is suitable with the functions <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> from base R and <code><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type()</a></code> from the <code>sf</code> package, as demonstrated below on the object <code>lisbon_road_segment</code> that is contained within the package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">lisbon_road_segment</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">lisbon_road_segment</span><span class="op">)</span>
<span class="co">#&gt; [1] LINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<p>Don’t worry if you don’t yet have your linear features in this class: you can read-in data from a wide range of formats into an <code>sf</code> object. You can also create <code>sf</code> objects from a matrix of coordinates, as illustrated below (don’t worry about the details for now, you can read up on how all this works in the <code>sf</code> package <a href="https://r-spatial.github.io/sf/articles/sf1.html">documentation</a>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9.1333</span>, <span class="op">-</span><span class="fl">9.134</span>, <span class="op">-</span><span class="fl">9.13</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">38.714</span>, <span class="fl">38.712</span>, <span class="fl">38.710</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">sf_linestring</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>,
  crs <span class="op">=</span> <span class="fl">4326</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; [1] LINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<p>A quick way of testing if your object can have slopes calculated for it is to plot it in an interactive map and to check that underneath the object there is indeed terrain that will give the linestrings gradient:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tmap</span><span class="op">)</span>
<span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="co">#&gt; tmap mode set to interactive viewing</span>
<span class="fu">tm_shape</span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_lines</span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_basemap</span><span class="op">(</span><span class="fu">leaflet</span><span class="fu">::</span><span class="va">providers</span><span class="op">$</span><span class="va">Esri.WorldTopoMap</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-linestringmap-1.png" width="100%"></p>
<p>Imagine you want to calculate the gradient of the imaginary route shown above, starting at the Castelo de São Jorge and descending towards the coast.</p>
<p>You can do this as a two step process as follows.</p>
<p>Step 1: add elevations to each coordinate in the linestring (requires a MapBox API key):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sf_linestring_xyz</span> <span class="op">=</span> <span class="fu"><a href="reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">sf_linestring</span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: ceramic</span>
<span class="co">#&gt; Preparing to download: 16 tiles at zoom = 17 from </span>
<span class="co">#&gt; https://api.mapbox.com/v4/mapbox.terrain-rgb/</span></code></pre></div>
<p>You can check the elevations added to the new <code>sf_linestring_xyz</code> object by printing its coordinates, as follows (note the new Z column that goes from above 90 m above sea level to only 24 m in a short distance):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span>
<span class="co">#&gt;            X      Y    Z L1</span>
<span class="co">#&gt; [1,] -9.1333 38.714 91.4  1</span>
<span class="co">#&gt; [2,] -9.1340 38.712 66.9  1</span>
<span class="co">#&gt; [3,] -9.1300 38.710 24.0  1</span></code></pre></div>
<p>Step 2: calculate the average slope of the linestring</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/slope_xyz.html">slope_xyz</a></span><span class="op">(</span><span class="va">sf_linestring_xyz</span><span class="op">)</span>
<span class="co">#&gt;        1 </span>
<span class="co">#&gt; 0.104923</span></code></pre></div>
<p>The result, just over 0.1, tells us that it’s quite a steep slope, a 10% gradient <em>on average</em>.</p>
<p>If you already have a DEM, you can calculate the slopes directly as follows, with <code><a href="reference/slope_raster.html">slope_raster()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="co">#&gt; [1] "RasterLayer"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "raster"</span>
<span class="va">sf_linestring_proj</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">sf_linestring</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">lisbon_road_segment</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/slope_raster.html">slope_raster</a></span><span class="op">(</span>routes <span class="op">=</span> <span class="va">sf_linestring_proj</span>, dem <span class="op">=</span> <span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="co">#&gt;         1 </span>
<span class="co">#&gt; 0.1218691</span></code></pre></div>
<p>Likewise, if your linestring object already has X, Y and Z coordinates (e.g. from a GPS device), you can use the <code>slope_</code> functions directly. In any case, to use the <code>slopes</code> package you need elevation points, either as a vector, a matrix or as a digital elevation model (DEM) encoded as a raster dataset.</p>
</div>
<div id="calculating-the-gradient-of-roads" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-the-gradient-of-roads" class="anchor"></a>Calculating the gradient of roads</h2>
<p>Typical use cases for the package are calculating the slopes of geographic objects representing roads or other linear features (not the imaginary line shown in the previous section). These two types of input data are represented in the code output and plot below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A raster dataset included in the package:</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span> <span class="co"># digital elevation model</span>
<span class="co">#&gt; [1] "RasterLayer"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "raster"</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/getValues.html">values</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span><span class="op">)</span> <span class="co"># heights range from 0 to ~100m</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span>
<span class="co">#&gt;   0.000   8.598  30.233  33.733  55.691  97.906    4241</span>
<span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>

<span class="co"># A vector dataset included in the package:</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">lisbon_road_segments</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">lisbon_road_segments</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-dem-lisbon-1.png" width="100%"></p>
<p>Calculate the average gradient of each road segment as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_road_segments</span><span class="op">$</span><span class="va">slope</span> <span class="op">=</span> <span class="fu"><a href="reference/slope_raster.html">slope_raster</a></span><span class="op">(</span><span class="va">lisbon_road_segments</span>, dem <span class="op">=</span> <span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lisbon_road_segments</span><span class="op">$</span><span class="va">slope</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt; 0.00000 0.01246 0.03534 0.05462 0.08251 0.27583</span></code></pre></div>
<p>This created a new column, <code>slope</code> that represents the average, distance weighted slope associated with each road segment. The units represent the percentage incline, that is the change in elevation divided by distance. The summary of the result tells us that the average gradient of slopes in the example data is just over 5%. This result is equivalent to that returned by ESRI’s <code>Slope_3d()</code> in the <a href="https://desktop.arcgis.com/en/arcmap/10.3/tools/3d-analyst-toolbox/slope.htm">3D Analyst extension</a>, with a correlation between the ArcMap implementation and our implementation of more than 0.95 on our test dataset (we find higher correlations on larger datasets):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>
  <span class="va">lisbon_road_segments</span><span class="op">$</span><span class="va">slope</span>,    <span class="co"># slopes calculates by the slopes package</span>
  <span class="va">lisbon_road_segments</span><span class="op">$</span><span class="va">Avg_Slope</span> <span class="co"># slopes calculated by ArcMap's 3D Analyst extension</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 0.9770436</span></code></pre></div>
<p>We can now visualise the slopes calculated by the <code>slopes</code> package as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">dem_lisbon_raster</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lisbon_road_segments</span><span class="op">[</span><span class="st">"slope"</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-slope-vis-1.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># mapview::mapview(lisbon_road_segments["slope"], map.types = "Esri.WorldStreetMap")</span></code></pre></div>
<p>Imagine that we want to go from Santa Catarina to the East of the map to the Castelo de Sao Jorge to the West of the map:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tmap</span><span class="op">)</span>
<span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="co">#&gt; tmap mode set to interactive viewing</span>
<span class="fu">qtm</span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-route-1.png" width="100%"></p>
<p>We can convert the <code>lisbon_route</code> object into a 3d linestring object with X, Y and Z coordinates, as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_route_xyz</span> <span class="op">=</span> <span class="fu"><a href="reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_route</span>, <span class="va">dem_lisbon_raster</span><span class="op">)</span></code></pre></div>
<p>We can now visualise the elevation profile of the route as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-plot_slope-1.png" width="100%"></p>
<p>If you do not have a raster dataset representing elevations, you can automatically download them as follows (a step that is automatically done in the function <code><a href="reference/elevation_add.html">elevation_add()</a></code> shown in the basic example above, results of the subsequent code chunk not shown):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dem_mapbox</span> <span class="op">=</span> <span class="fu"><a href="reference/elevation_get.html">elevation_get</a></span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span>
<span class="va">lisbon_road_proj</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">lisbon_route</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">crs</a></span><span class="op">(</span><span class="va">dem_mapbox</span><span class="op">)</span><span class="op">)</span>
<span class="va">lisbon_route_xyz_mapbox</span> <span class="op">=</span> <span class="fu"><a href="reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_road_proj</span>, dem <span class="op">=</span> <span class="va">dem_mapbox</span><span class="op">)</span>
<span class="fu"><a href="reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz_mapbox</span><span class="op">)</span></code></pre></div>
<p>As outlined in the basic example above this can be done more concisely, as:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lisbon_route_xyz_auto</span> <span class="op">=</span> <span class="fu"><a href="reference/elevation_add.html">elevation_add</a></span><span class="op">(</span><span class="va">lisbon_route</span><span class="op">)</span>
<span class="co">#&gt; Preparing to download: 12 tiles at zoom = 15 from </span>
<span class="co">#&gt; https://api.mapbox.com/v4/mapbox.terrain-rgb/</span>
<span class="fu"><a href="reference/plot_slope.html">plot_slope</a></span><span class="op">(</span><span class="va">lisbon_route_xyz_auto</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-plotauto-1.png" width="100%"></p>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the slopes project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/itsleeds/slopes/">https://​github.com/​itsleeds/​slopes/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/itsleeds/slopes/issues">https://​github.com/​itsleeds/​slopes/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Robin Lovelace <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joey Talbot <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6520-4560" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Rosa Félix <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5642-6006" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/itsleeds/slopes/actions"><img src="https://github.com/itsleeds/slopes/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/itsleeds/slopes?branch=master"><img src="https://codecov.io/gh/itsleeds/slopes/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/420"><img src="https://badges.ropensci.org/420_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Joey Talbot, Rosa Félix.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
